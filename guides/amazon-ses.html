<!DOCTYPE html>
<html>

<head>
  <title>Quarkus - Amazon SES Client</title>
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='Content-Security-Policy' CONTENT="default-src 'none'; script-src 'self' 'unsafe-eval' 'sha256-ANpuoVzuSex6VhqpYgsG25OHWVA1I+F6aGU04LoI+5s=' 'sha256-ipy9P/3rZZW06mTLAR0EnXvxSNcnfSDPLDuh3kzbB1w=' js.bizographics.com https://www.redhat.com assets.adobedtm.com jsonip.com https://ajax.googleapis.com https://www.googletagmanager.com https://www.google-analytics.com https://use.fontawesome.com; style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; img-src 'self' *; media-src 'self' ; frame-src https://www.googletagmanager.com https://www.youtube.com; frame-ancestors 'none'; base-uri 'none'; object-src 'none'; form-action 'none'; font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;">
  <META HTTP-EQUIV='X-Frame-Options' CONTENT="DENY">
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <link rel="canonical" href="https://quarkus.io/guides/amazon-ses">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="https://quarkus.io/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="https://quarkus.io/feed.xml" title="Quarkus">
  <script src="https://quarkus.io/assets/javascript/goan.js" type="text/javascript"></script>
  <script src="https://quarkus.io/assets/javascript/hl.js" type="text/javascript"></script>
</head>

<body class="guides">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJWS5L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="navigation-wrapper">
  <div class="width-12-12">
    <div class="header navigation">
      <div class="logo-wrapper">
        
          <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        
      </div>
      <div class="nav-container">
        <nav>
          <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
          <ul class="nav-list">
            <li>
              <a href="/get-started/" class="">Get Started</a>
            </li>
            <li>
              <a href="/guides/" class="active">Guides</a>
            </li>
            <li>
              <a href="/community/" class="">Community</a>
            </li>
            <li>
              <a href="/support/" class="">Support</a>
            </li>
            <li>
              <a href="/blog/" class="">Blog</a>
            </li>
            <li>
              <a href="https://code.quarkus.io" class="button-cta secondary white">Start Coding</a>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>

  <div class="content">
    <div class="guide">
  <div class="width-12-12">
    <h1 class="text-caps">Quarkus - Amazon SES Client</h1>
    <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#set-up-ses-locally">Set up SES locally</a></li>
<li><a href="#using-ses-on-your-aws-account">Using SES on your AWS account</a>
<ul class="sectlevel2">
<li><a href="#set-up-aws-ses">Set up AWS SES</a></li>
</ul>
</li>
<li><a href="#solution">Solution</a></li>
<li><a href="#creating-the-maven-project">Creating the Maven project</a></li>
<li><a href="#creating-json-rest-service">Creating JSON REST service</a></li>
<li><a href="#configuring-ses-clients">Configuring SES clients</a></li>
<li><a href="#next-steps">Next steps</a>
<ul class="sectlevel2">
<li><a href="#packaging">Packaging</a></li>
<li><a href="#going-asynchronous">Going asynchronous</a></li>
</ul>
</li>
<li><a href="#configuration-reference">Configuration Reference</a></li>
</ul></div>
    <div>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Amazon Simple Email Service (SES) is a flexible and highly-scalable email sending and receiving service.
Using SES, you can send emails with any type of correspondence. You can find more information about SES at <a href="https://aws.amazon.com/ses/">the Amazon SES website</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The SES extension is based on <a href="https://docs.aws.amazon.com/sdk-for-java/v2/developer-guide/welcome.html">AWS Java SDK 2.x</a>.
It&#8217;s a major rewrite of the 1.x code base that offers two programming models (Blocking &amp; Async).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This technology is considered preview.</p>
</div>
<div class="paragraph">
<p>In <em>preview</em>, backward compatibility and presence in the ecosystem is not guaranteed.
Specific improvements might require to change configuration or APIs and plans to become <em>stable</em> are under way.
Feedback is welcome on our <a href="https://groups.google.com/d/forum/quarkus-dev">mailing list</a> or as issues in our <a href="https://github.com/quarkusio/quarkus/issues">GitHub issue tracker</a>.</p>
</div>
<div class="paragraph">
<p>For a full list of possible extension statuses, check our <a href="https://quarkus.io/faq/#extension-status">FAQ entry</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Quarkus extension supports two programming models:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Blocking access using URL Connection HTTP client (by default) or the Apache HTTP Client</p>
</li>
<li>
<p><a href="https://docs.aws.amazon.com/sdk-for-java/v2/developer-guide/basics-async.html">Asynchronous programming</a> based on JDK&#8217;s <code>CompletableFuture</code> objects and the Netty HTTP client.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this guide, we see how you can get your REST services to use SES locally and on AWS.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To complete this guide, you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JDK 1.8+ installed with <code>JAVA_HOME</code> configured appropriately</p>
</li>
<li>
<p>an IDE</p>
</li>
<li>
<p>Apache Maven 3.6.2+</p>
</li>
<li>
<p>An AWS Account to access the SES service</p>
</li>
<li>
<p>Docker for your system to run SES locally for testing purposes</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="set-up-ses-locally"><a class="anchor" href="#set-up-ses-locally"></a>Set up SES locally</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The easiest way to start working with SES is to run a local instance as a container.
However, local instance of SES is only mocks the SES APIs without the actual email sending capabilities. You can still use it for this guide to verify an API communication or integration test purposes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="shell" class="language-shell hljs">docker run --rm --name local-ses 8012:4579 -e SERVICES=ses -e START_WEB=0 -d localstack/localstack:0.11.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>This starts a SES instance that is accessible on port <code>8012</code>.</p>
</div>
<div class="paragraph">
<p>Create an AWS profile for your local instance using AWS CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="shell" class="language-shell hljs">$ aws configure --profile localstack
AWS Access Key ID [None]: test-key
AWS Secret Access Key [None]: test-secret
Default region name [None]: us-east-1
Default output format [None]:</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-ses-on-your-aws-account"><a class="anchor" href="#using-ses-on-your-aws-account"></a>Using SES on your AWS account</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Amazon applies certain restrictions to new Amazon SES accounts, mainly to prevent fraud and abuse. All new accounts are in the Amazon SES <strong>sandbox</strong>.
All the features of the Amazon SES are still available while in sandbox, but a following restrictions applies:
- You can send mail to verified email addresses and domains or to the <a href="https://docs.aws.amazon.com/ses/latest/DeveloperGuide/send-email-simulator.html">Amazon SES mailbox simulator</a>
- You can only send mail from verified email addresses and domains
- You can send a maximum of 1 message per second.</p>
</div>
<div class="paragraph">
<p>Going production, you&#8217;d need to get your account of the sandbox following the <a href="https://docs.aws.amazon.com/ses/latest/DeveloperGuide/request-production-access.html">Amazon procedure</a>.</p>
</div>
<div class="sect2">
<h3 id="set-up-aws-ses"><a class="anchor" href="#set-up-aws-ses"></a>Set up AWS SES</h3>
<div class="paragraph">
<p>We assume you are going to use AWS SES sandbox for the sake of this guide. But before sending any email, you must verify sender and recipient email addresses using AWS CLI.
You can use your personal email or any temporary email service available if you wish.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="shell" class="language-shell hljs">aws ses verify-email-identity --email-address &lt;sender@email.address&gt;
aws ses verify-email-identity --email-address &lt;recipient@email.address&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, you need to open a mailboxes of those email addresses in order to follow confirmation procedure. Once email is approved you can use it in your application.</p>
</div>
<div class="paragraph">
<p>If you are using local SES you still need to verify email addresses, otherwise your send emaik in order to let local SES accepting your request.
However, no emails to be send as it only mocks the service APIs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="shell" class="language-shell hljs">aws ses verify-email-identity --email-address &lt;sender@email.address&gt; --profile localstack --endpoint-url=http://localhost:8012
aws ses verify-email-identity --email-address &lt;recipient@email.address&gt; --profile localstack --endpoint-url=http://localhost:8012</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="solution"><a class="anchor" href="#solution"></a>Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The application built here allows sending text emails to the recipients that are verified on AWS SES.</p>
</div>
<div class="paragraph">
<p>We recommend that you follow the instructions in the next sections and create the application step by step.
However, you can go right to the completed example.</p>
</div>
<div class="paragraph">
<p>Clone the Git repository: <code>git clone <a href="https://github.com/quarkusio/quarkus-quickstarts.git" class="bare">https://github.com/quarkusio/quarkus-quickstarts.git</a></code>, or download an <a href="https://github.com/quarkusio/quarkus-quickstarts/archive/master.zip">archive</a>.</p>
</div>
<div class="paragraph">
<p>The solution is located in the <code>amazon-ses-quickstart</code> <a href="https://github.com/quarkusio/quarkus-quickstarts/tree/master/amazon-ses-quickstart">directory</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-the-maven-project"><a class="anchor" href="#creating-the-maven-project"></a>Creating the Maven project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, we need a new project. Create a new project with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="shell" class="language-shell hljs">mvn io.quarkus:quarkus-maven-plugin:1.5.0.Final:create \
    -DprojectGroupId=org.acme \
    -DprojectArtifactId=amazon-ses-quickstart \
    -DclassName="org.acme.ses.QuarkusSesSyncResource" \
    -Dpath="/sync" \
    -Dextensions="resteasy-jsonb,amazon-ses,resteasy-mutiny"
cd amazon-ses-quickstart</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command generates a Maven structure importing the RESTEasy/JAX-RS, Mutiny and Amazon SES Client extensions.
After this, the <code>amazon-ses</code> extension has been added to your <code>pom.xml</code> as well as the Mutiny support for RESTEasy.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-json-rest-service"><a class="anchor" href="#creating-json-rest-service"></a>Creating JSON REST service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Lets create a <code>org.acme.ses.QuarkusSesSyncResource</code> that will provide an API to send emails using the synchronous client.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">{  }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-ses-clients"><a class="anchor" href="#configuring-ses-clients"></a>Configuring SES clients</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Both SES clients (sync and async) are configurable via the <code>application.properties</code> file that can be provided in the <code>src/main/resources</code> directory.
Additionally, you need to add to the classpath a proper implementation of the sync client. By default the extension uses the URL connection HTTP client, so
you need to add a URL connection client dependency to the <code>pom.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="xml" class="language-xml hljs">&lt;dependency&gt;
    &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;
    &lt;artifactId&gt;url-connection-client&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to use Apache HTTP client instead, configure it as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.ses.sync-client.type=apache</code></pre>
</div>
</div>
<div class="paragraph">
<p>And add the following dependency to the application <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="xml" class="language-xml hljs">&lt;dependency&gt;
    &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;
    &lt;artifactId&gt;apache-client&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;re going to use a local SES instance, configure it as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.ses.endpoint-override=http://localhost:8012

quarkus.ses.aws.region=us-east-1
quarkus.ses.aws.credentials.type=static
quarkus.ses.aws.credentials.static-provider.access-key-id=test-key
quarkus.ses.aws.credentials.static-provider.secret-access-key=test-secret</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.ses.aws.region</code> - It&#8217;s required by the client, but since you&#8217;re using a local SES instance use <code>us-east-1</code> as it&#8217;s a default region of localstack&#8217;s SES.</p>
</li>
<li>
<p><code>quarkus.ses.aws.credentials.type</code> - Set <code>static</code> credentials provider with any values for <code>access-key-id</code> and <code>secret-access-key</code></p>
</li>
<li>
<p><code>quarkus.ses.endpoint-override</code> - Override the SES client to use a local instance instead of an AWS service</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to work with an AWS account, you can simply remove or comment out all Amazon SES related properties. By default, the SES client extension
will use the <code>default</code> credentials provider chain that looks for credentials in this order:
- Java System Properties - <code>aws.accessKeyId</code> and <code>aws.secretKey</code>
* Environment Variables - <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code>
* Credential profiles file at the default location (<code>~/.aws/credentials</code>) shared by all AWS SDKs and the AWS CLI
* Credentials delivered through the Amazon EC2 container service if the <code>AWS_CONTAINER_CREDENTIALS_RELATIVE_URI</code> environment variable is set and the security manager has permission to access the variable,
* Instance profile credentials delivered through the Amazon EC2 metadata service</p>
</div>
<div class="paragraph">
<p>And the region from your AWS CLI profile will be used.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="next-steps"><a class="anchor" href="#next-steps"></a>Next steps</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="packaging"><a class="anchor" href="#packaging"></a>Packaging</h3>
<div class="paragraph">
<p>Packaging your application is as simple as <code>./mvnw clean package</code>.
It can be run with <code>java -jar target/amazon-ses-quickstart-1.0-SNAPSHOT-runner.jar</code>.</p>
</div>
<div class="paragraph">
<p>With GraalVM installed, you can also create a native executable binary: <code>./mvnw clean package -Dnative</code>.
Depending on your system, that will take some time.</p>
</div>
</div>
<div class="sect2">
<h3 id="going-asynchronous"><a class="anchor" href="#going-asynchronous"></a>Going asynchronous</h3>
<div class="paragraph">
<p>Thanks to the AWS SDK v2.x used by the Quarkus extension, you can use the asynchronous programming model out of the box.</p>
</div>
<div class="paragraph">
<p>Create a <code>org.acme.ses.QuarkusSesAsyncResource</code> REST resource that will be similar to our <code>QuarkusSesSyncResource</code> but using an asynchronous programming model.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">{  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>We create <code>Uni</code> instances from the <code>CompletionStage</code> objects returned by the asynchronous SES client, and then transform the emitted item.</p>
</div>
<div class="paragraph">
<p>And we need to add the Netty HTTP client dependency to the <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="xml" class="language-xml hljs">&lt;dependency&gt;
    &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;
    &lt;artifactId&gt;netty-nio-client&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-reference"><a class="anchor" href="#configuration-reference"></a>Configuration Reference</h2>
<div class="sectionbody">

</div>
</div>
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license.<br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>Github Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what youâ€™ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links width-1-12">
          
            <li><a href="/">Home</a></li>
          
            <li><a href="/guides">Guides</a></li>
          
            <li><a href="/community/#contributing">Contribute</a></li>
          
            <li><a href="/faq">FAQ</a></li>
          
            <li><a href="/get-started">Get Started</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Contribute</span>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://twitter.com/quarkusio">Follow us</a></li>
          
            <li><a href="https://github.com/quarkusio">GitHub</a></li>
          
            <li><a href="/security">Security issues</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev">Forums</a></li>
          
            <li><a href="https://quarkusio.zulipchat.com">Chatroom</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-3-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>
  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="https://quarkus.io/guides/javascript/config.js" type="text/javascript"></script>
</body>

</html>
