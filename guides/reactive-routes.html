<!DOCTYPE html>
<html>

<head>
  <title>Using Reactive Routes</title>
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='Content-Security-Policy' CONTENT="default-src 'none'; script-src 'self' 'unsafe-eval' 'sha256-ANpuoVzuSex6VhqpYgsG25OHWVA1I+F6aGU04LoI+5s=' 'sha256-ipy9P/3rZZW06mTLAR0EnXvxSNcnfSDPLDuh3kzbB1w=' js.bizographics.com https://www.redhat.com assets.adobedtm.com jsonip.com https://ajax.googleapis.com https://www.googletagmanager.com https://www.google-analytics.com https://use.fontawesome.com; style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; img-src 'self' *; media-src 'self' ; frame-src https://www.googletagmanager.com https://www.youtube.com; frame-ancestors 'none'; base-uri 'none'; object-src 'none'; form-action 'none'; font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;">
  <META HTTP-EQUIV='X-Frame-Options' CONTENT="DENY">
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <link rel="canonical" href="https://quarkus.io/guides/reactive-routes">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="https://quarkus.io/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="https://quarkus.io/feed.xml" title="Quarkus">
  <script src="https://quarkus.io/assets/javascript/goan.js" type="text/javascript"></script>
  <script src="https://quarkus.io/assets/javascript/hl.js" type="text/javascript"></script>
</head>

<body class="guides">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJWS5L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="navigation-wrapper">
  <div class="width-12-12">
    <div class="header navigation">
      <div class="logo-wrapper">
        
          <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        
      </div>
      <div class="nav-container">
        <nav>
          <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
          <ul class="nav-list">
            <li>
              <a href="/get-started/" class="">Get Started</a>
            </li>
            <li>
              <a href="/guides/" class="active">Guides</a>
            </li>
            <li>
              <a href="/community/" class="">Community</a>
            </li>
            <li>
              <a href="/blog/" class="">Blog</a>
            </li>
            <li>
              <a href="https://code.quarkus.io" class="button-cta secondary white">Start Coding</a>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>

  <div class="content">
    <div class="guide">
  <div class="width-12-12">
    <h1 class="text-caps">Using Reactive Routes</h1>
    <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#quarkus-http">Quarkus HTTP</a></li>
<li><a href="#declaring-reactive-routes">Declaring reactive routes</a>
<ul class="sectlevel2">
<li><a href="#routebase"><code>@RouteBase</code></a></li>
</ul>
</li>
<li><a href="#using-the-vert-x-web-router">Using the Vert.x Web Router</a></li>
<li><a href="#intercepting-http-requests">Intercepting HTTP requests</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul></div>
    <div>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Reactive routes propose an alternative approach to implement HTTP endpoints where you declare and chain <em>routes</em>.
This approach became very popular in the JavaScript world, with frameworks like Express.Js or Hapi.
Quarkus also offers the possibility to use reactive routes.
You can implement REST API with routes only or combine them with JAX-RS resources and servlets.</p>
</div>
<div class="paragraph">
<p>The code presented in this guide is available in this <a href="https://github.com/quarkusio/quarkus-quickstarts">Github repository</a> under the <a href="https://github.com/quarkusio/quarkus-quickstarts/tree/master/reactive-routes-quickstart"><code>reactive-routes-quickstart</code> directory</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="quarkus-http"><a class="anchor" href="#quarkus-http"></a>Quarkus HTTP</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before going further, let&#8217;s have a look at the HTTP layer of Quarkus.
Quarkus HTTP support is based on a non-blocking and reactive engine (Eclipse Vert.x and Netty).
All the HTTP requests your application receive are handled by <em>event loops</em> (IO Thread) and then are routed towards the code that manages the request.
Depending on the destination, it can invoke the code managing the request on a worker thread (Servlet, Jax-RS) or use the IO Thread (reactive route).
Note that because of this, a reactive route must be non-blocking or explicitly declare its blocking nature (which would result by being called on a worker thread).</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="/guides/images/http-architecture.png" alt="Quarkus HTTP Architecture"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="declaring-reactive-routes"><a class="anchor" href="#declaring-reactive-routes"></a>Declaring reactive routes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first way to use reactive routes is to use the <code>@Route</code> annotation.
To have access to this annotation, you need to add the <code>quarkus-vertx-web</code> extension:</p>
</div>
<div class="paragraph">
<p>In your <code>pom.xml</code> file, add:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="xml" class="language-xml hljs">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-vertx-web&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then in a <em>bean</em>, you can use the <code>@Route</code> annotation as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">package org.acme.quarkus.sample;

import io.quarkus.vertx.web.Route;
import io.quarkus.vertx.web.RoutingExchange;
import io.vertx.core.http.HttpMethod;
import io.vertx.ext.web.RoutingContext;

import javax.enterprise.context.ApplicationScoped;

@ApplicationScoped <i class="conum" data-value="1"></i><b>(1)</b>
public class MyDeclarativeRoutes {

    // neither path nor regex is set - match a path derived from the method name
    @Route(methods = HttpMethod.GET) <i class="conum" data-value="2"></i><b>(2)</b>
    void hello(RoutingContext rc) { <i class="conum" data-value="3"></i><b>(3)</b>
        rc.response().end("hello");
    }

    @Route(path = "/greetings", methods = HttpMethod.GET)
    void greetings(RoutingExchange ex) { <i class="conum" data-value="4"></i><b>(4)</b>
        ex.ok("hello " + ex.getParam("name").orElse("world"));
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If there is a reactive route found on a class with no scope annotation then <code>@javax.inject.Singleton</code> is added automatically.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>@Route</code> annotation indicates that the method is a reactive route. Again, by default, the code contained in the method must not block.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The method gets a <a href="https://vertx.io/docs/apidocs/io/vertx/ext/web/RoutingContext.html"><code>RoutingContext</code></a> as a parameter. From the <code>RoutingContext</code> you can retrieve the HTTP request (using <code>request()</code>) and write the response using <code>response().end(&#8230;&#8203;)</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>RoutingExchange</code> is a convenient wrapper of <code>RoutingContext</code> which provides some useful methods.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>More details about using the <code>RoutingContext</code> is available in the <a href="https://vertx.io/docs/vertx-web/java/">Vert.x Web documentation</a>.</p>
</div>
<div class="paragraph">
<p>The <code>@Route</code> annotation allows to configure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>path</code> - for routing by path, using the <a href="https://vertx.io/docs/vertx-web/java/#_capturing_path_parameters">Vert.x Web format</a></p>
</li>
<li>
<p>The <code>regex</code> - for routing with regular expressions, see <a href="https://vertx.io/docs/vertx-web/java/#_routing_with_regular_expressions">for more details</a></p>
</li>
<li>
<p>The <code>methods</code> - the HTTP verb triggering the route such as <code>GET</code>, <code>POST</code>&#8230;&#8203;</p>
</li>
<li>
<p>The <code>type</code> - it can be <em>normal</em> (non-blocking), <em>blocking</em> (method dispatched on a worker thread), or <em>failure</em> to indicate that this route is called on failures</p>
</li>
<li>
<p>The <code>order</code> - the order of the route when several routes are involved in handling the incoming request.
Must be positive for regular user routes.</p>
</li>
<li>
<p>The produced and consumed mime types using <code>produces</code>, and <code>consumes</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For instance, you can declare a blocking route as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Route(methods = HttpMethod.POST, path = "/post", type = Route.HandlerType.BLOCKING)
public void blocking(RoutingContext rc) {
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also declare several routes for a single method using <code>@Routes</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Route(path = "/first")
@Route(path = "/second")
public void route(RoutingContext rc) {
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each route can use different paths, methods&#8230;&#8203;</p>
</div>
<div class="sect2">
<h3 id="routebase"><a class="anchor" href="#routebase"></a><code>@RouteBase</code></h3>
<div class="paragraph">
<p>This annotation can be used to configure some defaults for reactive routes declared on a class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@RouteBase(path = "simple", produces = "text/plain") <i class="conum" data-value="1"></i><b>(1)</b>
public class SimpleRoutes {

    @Route(path = "ping") // the final path is /simple/ping
    void ping(RoutingContext rc) {
        rc.response().end("pong");
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>path</code> value is used as a prefix for any route method declared on the class where <code>Route#path()</code> is used. The <code>produces</code> value is used for content-based routing for all routes where <code>Route#produces()</code> is empty.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-the-vert-x-web-router"><a class="anchor" href="#using-the-vert-x-web-router"></a>Using the Vert.x Web Router</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can also register your route directly on the <em>HTTP routing layer</em> by registering routes directly on the <code>Router</code> object.
To retrieve the <code>Router</code> instance at startup:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public void init(@Observes Router router) {
    router.get("/my-route").handler(rc -&gt; rc.response().end("Hello from my route"));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the <a href="https://vertx.io/docs/vertx-web/java/#_basic_vert_x_web_concepts">Vert.x Web documentation</a> to know more about the route registration, options, and available handlers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>Router</code> access is provided by the <code>quarkus-vertx-http</code> extension.
If you use <code>quarkus-resteasy</code> or <code>quarkus-vertx-web</code>, the extension will be added automatically.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="intercepting-http-requests"><a class="anchor" href="#intercepting-http-requests"></a>Intercepting HTTP requests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can also register filters that would intercept incoming HTTP requests.
Note that these filters are also applied for servlets, JAX-RS resources, and reactive routes.</p>
</div>
<div class="paragraph">
<p>For example, the following code snippet registers a filter adding an HTTP header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">package org.acme.quarkus.sample;

import io.vertx.ext.web.RoutingContext;

public class MyFilters {

    @RouteFilter(100) <i class="conum" data-value="1"></i><b>(1)</b>
    void myFilter(RoutingContext rc) {
       rc.response().putHeader("X-Header", "intercepting the request");
       rc.next(); <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>RouteFilter#value()</code> defines the priority used to sort the filters - filters with higher priority are called first.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The filter is likely required to call the <code>next()</code> method to continue the chain.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion"><a class="anchor" href="#conclusion"></a>Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide has introduced how you can use reactive routes to define an HTTP endpoint.
It also describes the structure of the Quarkus HTTP layer and how to write filters.</p>
</div>
</div>
</div>
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license.<br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> is hosted on <a href='https://pages.github.com/' target='_blank'>Github Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what youâ€™ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links width-1-12">
          
            <li><a href="/">Home</a></li>
          
            <li><a href="/guides">Guides</a></li>
          
            <li><a href="/community/#contributing">Contribute</a></li>
          
            <li><a href="/faq">FAQ</a></li>
          
            <li><a href="/get-started">Get Started</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Contribute</span>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://twitter.com/quarkusio">Follow us</a></li>
          
            <li><a href="https://github.com/quarkusio">GitHub</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev">Forums</a></li>
          
            <li><a href="https://quarkusio.zulipchat.com">Chatroom</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-3-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>
  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="https://quarkus.io/guides/javascript/config.js" type="text/javascript"></script>
</body>

</html>
